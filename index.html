<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FPOS</title>
  <style>
    /* 동일한 스타일 정의 */
    body {
      display: flex;
      font-family: Arial, sans-serif;
      margin: 5px;
      height: 100vh;
      flex-direction: column;
    }
    .container {
      display: flex;
      justify-content: space-between;
      flex-grow: 1;
    }
    .pay, .menu-container {
      flex: 1;
      padding: 20px;
    }
    .pay {
      border-right: 0.1px solid #ccc;
      background-color: #f8f8f8;
    }
    .menu-container {
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }
    .menu {
      margin-bottom: 20px;
      padding: 10px;
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .menu h2 {
      margin-bottom: 10px;
    }
    .menu button {
      padding: 10px;
      width: 220px;
      height: 50px;
      font-size: 16px;
      background-color: #008fe7;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.2s;
      white-space: nowrap;
      margin-bottom: 5px;
    }
    .menu button:hover {
      background-color: #379bdb;
    }
    .pay-item {
      margin-bottom: 5px;
      padding: 5px;
      display: flex;
      justify-content: space-between;
    }
    .pay-item span {
      display: inline-block;
    }
    .total {
      font-weight: bold;
      border-top: 2px solid #000;
      padding-top: 10px;
      margin-top: 20px;
    }
    .clear-button {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #09e938;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .clear-button:hover {
      background-color: #07c32e;
    }
    #receiptContainer {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ccc;
      background-color: #fff;
    }
    #receipt {
      white-space: pre-wrap;
      font-family: monospace;
    }
    .discount-button {
  margin-top: 10px;
  padding: 10px 20px;
  background-color: #5c61ef;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.2s;
}
.discount-button:hover {
  background-color: #5c61ef;
}
  </style>
</head>
<body>
  <div class="container">
    <div class="pay">
      <h2>결제 목록</h2>
      <div id="payItems"></div>
      <div class="total">결제 금액: <span id="totalPrice">0</span>원</div>
      <div class="total">총 수량: <span id="totalQuantity">0</span>개</div>
      <button class="clear-button" id="clearButton">결제하기</button>
      <button class="discount-button" id="govDiscountButton">공무원 할인</button>
      <button class="discount-button" id="partnerDiscountButton">협력사 할인</button>
      <div id="receiptContainer" style="display: none;">
        <h3>영수증</h3>
        <div id="receipt"></div>
      </div>
    </div>
    <div class="menu-container" id="menuContainer">
      <!-- 메뉴 항목들 -->
      <div class="menu">
        <h2>COFFEE</h2>
      <button data-name="아메리카노" data-price="4000">아메리카노</button>
      <button data-name="아인슈페너" data-price="4000">아인슈페너</button>
      <button data-name="에스프레소" data-price="3000">에스프레소</button>
      <button data-name="돌하르방 카푸치노" data-price="8000">돌하르방 카푸치노</button>
      <button data-name="카라멜 마끼야또" data-price="7000">카라멜 마끼야또</button>
      <button data-name="황금루왁커피" data-price="100000">황금루왁커피</button>
    </div>
    <div class="menu">
      <h2>LATTE</h2>
      <button data-name="카페 라떼" data-price="4000">카페라떼</button>
      <button data-name="녹차 라떼" data-price="4500">녹차 라떼</button>
      <button data-name="민초 라떼" data-price="5000">민초 라떼</button>
      <button data-name="달고나 라떼" data-price="7000">달고나 라떼</button>
      <button data-name="제주 쑥길 라떼" data-price="6000">제주 쑥길 라떼</button>
      <button data-name="현무암 라떼" data-price="8000">현무암 라떼</button>
    </div>
    <div class="menu">
      <h2>TEA</h2>
      <button data-name="밀크티" data-price="3000">밀크티</button>
      <button data-name="흑당 버블티" data-price="4000">흑당 버블티</button>
      <button data-name="얼그레이 홍차" data-price="5000">얼그레이 홍차</button>
    </div>
    <div class="menu">
      <h2>BAKERY</h2>
      <button data-name="유니콘 프라페" data-price="8000">유니콘 프라페</button>
      <button data-name="초코 스무디" data-price="8000">초코 스무디</button>
      <button data-name="딸기 스무디" data-price="8000">딸기 스무디</button>
      <button data-name="파르페 아이스크림" data-price="6000">파르페 아이스크림</button>
      <button data-name="아포카토 아이스크림" data-price="5000">아포카토 아이스크림</button>
      <button data-name="허니 브레드" data-price="5000">허니 브레드</button>
      <button data-name="치즈 케이크" data-price="5000">치즈 케이크</button>
      <button data-name="티라미수" data-price="5000">티라미수</button>
      <button data-name="딸기 마카롱" data-price="2000">딸기 마카롱</button>
      <button data-name="초코 마카롱" data-price="2000">초코 마카롱</button>
      <button data-name="오리지널 핫 번" data-price="3000">오리지널 핫 번</button>
      <button data-name="제주말차 카스테라" data-price="3000">제주말차 카스테라</button>
      <button data-name="감귤 롤케이크" data-price="7000">감귤 롤케이크</button>
      <button data-name="현무암 돌삥" data-price="3000">현무암 돌삥</button>
      <button data-name="에그 타르트" data-price="2000">에그 타르트</button>
      <button data-name="초콜릿 도넛" data-price="4000">초콜릿 도넛</button>
      <button data-name="와플" data-price="7000">와플</button>
    </div>
    <div class="menu">
      <h2>BRUNCH IN EODIYA</h2>
      <button data-name="어디야 모닝 센드위치" data-price="4000">어디야 모닝 센드위치</button>
      <button data-name="어디야 브런치 세트" data-price="8000">어디야 브런치 세트</button>
    </div>
  </div>
<script>
// 결제 항목을 저장할 객체
const items = {};
let totalOverallPayment = 0; // 모든 영수증의 총 결제 금액

const payItemsContainer = document.getElementById('payItems');
const totalPriceElement = document.getElementById('totalPrice');
const totalQuantityElement = document.getElementById('totalQuantity');
const clearButton = document.getElementById('clearButton');
const receiptContainer = document.getElementById('receiptContainer');
const overallTotalContainer = document.createElement('div'); // 총 수익 영역

// "총 수익" 컨테이너 스타일 설정
overallTotalContainer.id = 'overallTotal';
overallTotalContainer.style.marginTop = '20px';
overallTotalContainer.style.borderTop = '2px solid #000';
overallTotalContainer.style.paddingTop = '10px';
receiptContainer.appendChild(overallTotalContainer); // 초기 추가

// 결제 목록 업데이트 함수
function updatePayItems() {
  payItemsContainer.innerHTML = '';
  let total = 0;
  let totalQuantity = 0;

  for (const item in items) {
    const payItem = items[item];
    total += payItem.price * payItem.quantity;
    totalQuantity += payItem.quantity;

    const payItemElement = document.createElement('div');
    payItemElement.classList.add('pay-item');
    payItemElement.innerHTML = `
      <span>${item}</span>
      <span>${payItem.quantity}개</span>
      <span>${payItem.price * payItem.quantity}원</span>
      <button class="remove-button" data-name="${item}">취소</button>
    `;
    payItemsContainer.appendChild(payItemElement);
  }

  totalPriceElement.textContent = total;
  totalQuantityElement.textContent = totalQuantity;

  // 취소 버튼 처리
  const removeButtons = document.querySelectorAll('.remove-button');
  removeButtons.forEach(button => {
    button.addEventListener('click', function () {
      const name = button.dataset.name;
      delete items[name];
      updatePayItems();
    });
  });
}

// 결제 버튼 클릭 시 영수증 출력 및 초기화
clearButton.addEventListener('click', function () {
  let currentPaymentTotal = 0; // 현재 결제 금액
  let totalDiscount = 0; // 현재 할인 금액

  // 영수증 생성
  const receiptDiv = document.createElement('div');
  receiptDiv.classList.add('receipt');

  const categories = {};
  for (const item in items) {
    const payItem = items[item];
    const category = payItem.category || "기타";

    if (!categories[category]) {
      categories[category] = [];
    }

    categories[category].push({
      name: item,
      quantity: payItem.quantity,
      price: payItem.price,
      discount: payItem.discount || 0,
    });
  }

  // 카테고리별로 정리 후 영수증에 추가
  for (const category in categories) {
    const categoryDiv = document.createElement('div');
    categoryDiv.innerHTML = `<h4>${category}</h4>`;
    receiptDiv.appendChild(categoryDiv);

    categories[category].forEach(payItem => {
      const itemTotal = payItem.price * payItem.quantity;
      currentPaymentTotal += itemTotal; // 총 결제 금액 계산
      totalDiscount += payItem.discount; // 총 할인 금액 계산

      const receiptItem = document.createElement('div');
      receiptItem.textContent = `${payItem.name} x ${payItem.quantity} = ${itemTotal.toLocaleString()}원`;
      categoryDiv.appendChild(receiptItem);
    });
  }

  // 총 할인 및 결제된 금액 표시
  const summaryDiv = document.createElement('div');
  summaryDiv.style.marginTop = '10px';
  summaryDiv.innerHTML = `
    <div>할인 금액: ${totalDiscount.toLocaleString()}원</div>
    <strong>결제된 금액: ${(currentPaymentTotal - totalDiscount).toLocaleString()}원</strong>
  `;
  receiptDiv.appendChild(summaryDiv);

  // 총 수익 갱신
  totalOverallPayment += currentPaymentTotal - totalDiscount;

  // 기존 총 수익 제거
  const overallTotalDiv = document.getElementById('overallTotal');
  if (overallTotalDiv) {
    overallTotalDiv.remove();
  }

  // 총 수익을 새로운 위치로 이동
  const newOverallTotalDiv = document.createElement('div');
  newOverallTotalDiv.id = 'overallTotal';
  newOverallTotalDiv.style.marginTop = '20px';
  newOverallTotalDiv.innerHTML = `<h3>총 수익: ${totalOverallPayment.toLocaleString()}원</h3>`;
  receiptContainer.appendChild(newOverallTotalDiv);

  // 영수증 추가
  receiptContainer.insertBefore(receiptDiv, newOverallTotalDiv);

  // 결제 목록 초기화
  Object.keys(items).forEach(item => delete items[item]);
  updatePayItems();
});

  // 결제 목록 갱신
  updatePayItems();

  // **전체 총 수익**을 한 번만 갱신 (총 수익 중복 추가 방지)
  let overallTotalDiv = document.getElementById('overallTotal'); // 총 결제 금액 영역
  if (!overallTotalDiv) {
    // 처음 실행 시 총 결제 금액 영역 생성
    overallTotalDiv = document.createElement('div');
    overallTotalDiv.id = 'overallTotal';
    overallTotalDiv.style.marginTop = '20px';
    overallTotalDiv.innerHTML = `<h3>총 수익: ${totalOverallPayment.toLocaleString()}원</h3>`;
    receiptContainer.appendChild(overallTotalDiv);
  } else {
    // 이미 영역이 있으면 내용 업데이트
    overallTotalDiv.innerHTML = `<h3>총 수익: ${totalOverallPayment.toLocaleString()}원</h3>`;
  }

  // 영수증 컨테이너를 보이게 설정
  receiptContainer.style.display = 'block';
});
</script>
</body>
</html>
